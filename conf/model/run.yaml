defaults:
  - pipeline/default@_here_
  - _self_

x_sys:
  steps:
    - _target_: src.modules.transformation.x.nan_to_zero.NanToZero
      years: ["2024"]
y_sys:

train_sys:
  steps:
    - _target_: src.modules.training.main_trainer.MainTrainer
      year: "2024"
      dataset_args:
        sampler: 
          _target_: src.modules.training.datasets.sampler.crop_or_pad.CropOrPad
          length: 160000
        to_2d:
          _target_: src.modules.training.datasets.to_2d.reshape.Reshape
          shape: [400,400]
        labeler:
          _target_: src.modules.training.datasets.labeler.psd_labeler.PSDLabeler
      n_folds: 2 # 0 for train full,
      epochs: 20
      patience: 10
      batch_size: 32
      model:
        _target_: src.modules.training.models.mlp.MLP
        input_dim: 2
        output_dim: 1
      criterion:
        _target_: torch.nn.BCELoss
      optimizer:
        _target_: functools.partial
        _args_:
          - _target_: hydra.utils.get_class
            path: torch.optim.AdamW
        lr: 1e-3
